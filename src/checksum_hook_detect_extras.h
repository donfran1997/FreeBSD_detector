/*

###################################################################
#                                                                 #
#   ROOTKIT DETECTOR                                              #
#   UNSW COMP6448 2019tX (01/2019-02/2019)                        #
#                                                                 #
#   The below program has been written by the students            #
#   of the COMP6448 - Security Masterclass course in              #
#   the Jan/Feb of 2019 Summer Term.                              #
#                                                                 #
#   This program draws from student detectors submitted           #
#   in 2018s2 COMP6447 - System and Software Security Assessment  #
#                                                                 #
###################################################################

    checksum_hook_detect_extras.h
    Contains data arrays for the checksum function
    In a further iteration of this program
    This file could be auto generated by "fingerprinting" a clean system

*/
#ifndef _CHECKSUM_HOOK_DETECT_EXTRAS_H_
#define _CHECKSUM_HOOK_DETECT_EXTRAS_H_
#include <sys/types.h>
#include <sys/param.h>
#include <sys/proc.h>
#include <sys/module.h>
#include <sys/sysent.h>
#include <sys/kernel.h>
#include <sys/systm.h>
#include <sys/sysproto.h>
#include <sys/imgact.h>
#include <sys/uio.h>
#include <sys/syscallsubr.h>
#include <sys/fcntl.h>
#include <sys/limits.h>
#include <sys/stat.h>
#include <sys/linker.h>
#include <sys/sx.h>
#include <security/audit/audit.h>

int checksum_algo[] = {
1445,
1080,
1598,
1559,
1559,
1301,
1346,
1443,
1445,
947,
883,
1445,
1080,
1445,
1301,
945,
1144,
1249,
1443,
1445,
1021,
1225,
1443,
1241,
1146,
1146,
1596,
1445,
1445,
1445,
1034,
1221,
1221,
1148,
1081,
1445,
1079,
1445,
1445,
1138,
1445,
1080,
1176,
1146,
1221,
1443,
1445,
1146,
1445,
1257,
1257,
1443,
1445,
1445,
1443,
1445,
1443,
1144,
1152,
1445,
1059,
1443,
1445,
1445,
1445,
1074,
1598,
1445,
1445,
968,
968,
1445,
945,
1297,
1053,
1075,
1445,
1445,
1301,
1074,
1277,
1078,
1225,
1445,
1445,
1443,
1598,
1445,
1445,
1059,
1297,
1445,
1301,
1598,
1445,
1081,
1225,
1301,
1055,
1445,
1221,
1445,
1445,
1445,
1055,
1160,
1297,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1598,
1598,
1103,
1445,
1121,
1121,
1445,
1445,
1445,
1445,
1249,
1241,
1144,
1445,
1445,
1445,
1148,
1551,
1297,
1221,
1148,
1080,
1144,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1221,
1443,
1445,
1445,
1445,
1445,
1445,
1443,
1153,
1445,
1443,
1443,
1445,
1443,
1443,
1132,
1181,
1229,
1445,
1445,
1445,
1445,
1198,
1198,
1198,
1445,
1598,
1598,
1152,
1445,
1445,
1445,
1445,
1445,
1229,
1229,
1233,
1445,
1445,
1445,
1445,
1598,
1598,
1598,
1208,
1297,
1445,
1445,
1598,
1121,
1321,
1445,
1309,
1305,
1305,
1313,
1150,
1297,
1443,
1144,
1086,
1445,
1527,
1301,
1709,
1709,
1709,
1709,
1709,
1709,
1709,
1709,
1709,
1445,
1237,
1443,
1445,
1443,
1237,
1095,
1111,
1301,
1445,
1237,
1225,
1598,
1598,
1527,
1445,
1346,
1445,
1598,
1346,
1445,
1001,
1001,
1001,
1445,
1445,
1445,
1221,
1445,
1445,
1061,
1445,
1527,
1021,
777,
1004,
1004,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1221,
1445,
945,
777,
1144,
1074,
1596,
1443,
1596,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1121,
1121,
1445,
1445,
1445,
1445,
1445,
1445,
1443,
1445,
1443,
1152,
1445,
1230,
1249,
1027,
1080,
1059,
1202,
1031,
1178,
1086,
1253,
1241,
1445,
1225,
1445,
1445,
1019,
1048,
1048,
1445,
1234,
1445,
1445,
1027,
1106,
779,
1445,
1445,
1445,
1059,
792,
1089,
1089,
1598,
1110,
1551,
1445,
1575,
1693,
1445,
1535,
1445,
1445,
1443,
1445,
1445,
1443,
1443,
1445,
1445,
1443,
1445,
1443,
1445,
1443,
1443,
1443,
1443,
1445,
1074,
1074,
1043,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1443,
1443,
1443,
1001,
1445,
1146,
1693,
1031,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1445,
1443,
1445,
1443,
1237,
1081,
1066,
1017,
1249,
1048,
1090,
1090,
1445,
1445,
1693,
1693,
1693,
1693,
1693,
1693,
1693,
1693,
1693,
1445,
1443,
1443,
1443,
1443,
1443,
1445,
1445,
1435,
1445,
1445,
1445,
1435,
1588,
1435,
1443,
1443,
1443,
1443,
1443,
1445,
1588,
1156,
1150,
1445,
1445,
1445,
1090,
1445,
1443,
1443,
1445,
1693,
1527,
1056,
1017,
1027,
1445,
1442,
1225,
1445,
1445,
1325,
1445,
1443,
1009,
1598,
1572,
1693,
1693,
1693,
1693,
1693,
1693,
1281,
1279,
984,
1445,
1445,
1445,
1445,
1445,
1445,
1443,
1443,
1443,
1598,
1598,
1317,
1305,
1301,
1301,
1445,
949,
1225,
1059,
1058,
1223,
1313,
1313,
1301,
1141,
1145,
1445,
1598,
1144,
1145,
949,
949,
949,
1156,
1156,
1144,
1144,
1007,
1221,
1693,
1119,
1119,
1237,
1221,
1598,
1445,
1445,
1144,
1445,
1445,
1221,
975,
1445,
1445,
1445,
1445,
1445,
1100,
1269,
1213,
1225,
1217,
1163,
1163,
1021,
1021,
1443,
1445,
1066,
1221,
1221,
1007,
1055,
1055,
1020,
1020,
1221,
1004,
1445,
1445,
1144,
1156,
1598,
1445,
1080
};

int syscall_ids[] = {0,
1,
2,
3,
4,
5,
6,
7,
8,
9,
10,
11,
12,
13,
14,
15,
16,
17,
18,
19,
20,
21,
22,
23,
24,
25,
26,
27,
28,
29,
30,
31,
32,
33,
34,
35,
36,
37,
38,
39,
40,
41,
42,
43,
44,
45,
46,
47,
48,
49,
50,
51,
52,
53,
54,
55,
56,
57,
58,
59,
60,
61,
62,
63,
64,
65,
66,
67,
68,
69,
70,
71,
72,
73,
74,
75,
76,
77,
78,
79,
80,
81,
82,
83,
84,
85,
86,
87,
88,
89,
90,
91,
92,
93,
94,
95,
96,
97,
98,
99,
100,
101,
102,
103,
104,
105,
106,
107,
108,
109,
110,
111,
112,
113,
114,
115,
116,
117,
118,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
148,
149,
150,
151,
152,
153,
154,
155,
156,
157,
158,
159,
160,
161,
162,
163,
164,
165,
166,
167,
168,
169,
170,
171,
172,
173,
174,
175,
176,
177,
178,
179,
180,
181,
182,
183,
184,
185,
186,
187,
188,
189,
190,
191,
192,
193,
194,
195,
196,
197,
198,
199,
200,
201,
202,
203,
204,
205,
206,
207,
208,
209,
210,
211,
212,
213,
214,
215,
216,
217,
218,
219,
220,
221,
222,
223,
224,
225,
226,
227,
228,
229,
230,
231,
232,
233,
234,
235,
236,
237,
238,
239,
240,
241,
242,
243,
244,
245,
246,
247,
248,
249,
250,
251,
252,
253,
254,
255,
256,
257,
258,
259,
260,
261,
262,
263,
264,
265,
266,
267,
268,
269,
270,
271,
272,
273,
274,
275,
276,
277,
278,
279,
280,
281,
282,
283,
284,
285,
286,
287,
288,
289,
290,
291,
292,
293,
294,
295,
296,
297,
298,
299,
300,
301,
302,
303,
304,
305,
306,
307,
308,
309,
310,
311,
312,
313,
314,
315,
316,
317,
318,
319,
320,
321,
322,
323,
324,
325,
326,
327,
328,
329,
330,
331,
332,
333,
334,
335,
336,
337,
338,
339,
340,
341,
342,
343,
344,
345,
346,
347,
348,
349,
350,
351,
352,
353,
354,
355,
356,
357,
358,
359,
360,
361,
362,
363,
364,
365,
366,
367,
368,
369,
370,
371,
372,
373,
374,
375,
376,
377,
378,
379,
380,
381,
382,
383,
384,
385,
386,
387,
388,
389,
390,
391,
392,
393,
394,
395,
396,
397,
398,
399,
400,
401,
402,
403,
404,
405,
406,
407,
408,
409,
410,
411,
412,
413,
414,
415,
416,
417,
418,
419,
420,
421,
422,
423,
424,
425,
426,
427,
428,
429,
430,
431,
432,
433,
434,
435,
436,
437,
438,
439,
440,
441,
442,
443,
444,
445,
446,
447,
448,
449,
450,
451,
452,
453,
454,
455,
456,
457,
458,
459,
460,
461,
462,
463,
464,
465,
466,
467,
468,
469,
470,
471,
472,
473,
474,
475,
476,
477,
478,
479,
480,
481,
482,
483,
484,
485,
486,
487,
488,
489,
490,
491,
492,
493,
494,
495,
496,
497,
498,
499,
500,
501,
502,
503,
504,
505,
506,
507,
508,
509,
510,
511,
512,
513,
514,
515,
516,
517,
518,
519,
520,
521,
522,
523,
524,
525,
526,
527,
528,
529,
530,
531,
532,
533,
534,
535,
536,
537,
538,
539,
540,
541,
542,
543,
544,
545,
546,
547,
548,
549,
550
};



void* functions[] = {
nosys,
sys_sys_exit,
sys_fork,
sys_read,
sys_write,
sys_open,
sys_close,
sys_wait4,
nosys,
sys_link,
sys_unlink,
nosys,
sys_chdir,
sys_fchdir,
sys_mknod,
sys_chmod,
sys_chown,
sys_obreak,
freebsd4_getfsstat,
nosys,
sys_getpid,
sys_mount,
sys_unmount,
sys_setuid,
sys_getuid,
sys_geteuid,
sys_ptrace,
sys_recvmsg,
sys_sendmsg,
sys_recvfrom,
sys_accept,
sys_getpeername,
sys_getsockname,
sys_access,
sys_chflags,
sys_fchflags,
sys_sync,
sys_kill,
nosys,
sys_getppid,
nosys,
sys_dup,
freebsd10_pipe,
sys_getegid,
sys_profil,
sys_ktrace,
nosys,
sys_getgid,
nosys,
sys_getlogin,
sys_setlogin,
sys_acct,
nosys,
sys_sigaltstack,
sys_ioctl,
sys_reboot,
sys_revoke,
sys_symlink,
sys_readlink,
sys_execve,
sys_umask,
sys_chroot,
nosys,
nosys,
nosys,
sys_msync,
sys_vfork,
nosys,
nosys,
sys_sbrk,
sys_sstk,
nosys,
sys_ovadvise,
sys_munmap,
sys_mprotect,
sys_madvise,
nosys,
nosys,
sys_mincore,
sys_getgroups,
sys_setgroups,
sys_getpgrp,
sys_setpgid,
sys_setitimer,
nosys,
sys_swapon,
sys_getitimer,
nosys,
nosys,
sys_getdtablesize,
sys_dup2,
nosys,
sys_fcntl,
sys_select,
nosys,
sys_fsync,
sys_setpriority,
sys_socket,
sys_connect,
nosys,
sys_getpriority,
nosys,
nosys,
nosys,
sys_bind,
sys_setsockopt,
sys_listen,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
sys_gettimeofday,
sys_getrusage,
sys_getsockopt,
nosys,
sys_readv,
sys_writev,
sys_settimeofday,
sys_fchown,
sys_fchmod,
nosys,
sys_setreuid,
sys_setregid,
sys_rename,
nosys,
nosys,
sys_flock,
sys_mkfifo,
sys_sendto,
sys_shutdown,
sys_socketpair,
sys_mkdir,
sys_rmdir,
sys_utimes,
nosys,
sys_adjtime,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
sys_setsid,
sys_quotactl,
nosys,
nosys,
nosys,
nosys,
nosys,
sys_nlm_syscall,
sys_nfssvc,
nosys,
freebsd4_statfs,
freebsd4_fstatfs,
nosys,
sys_lgetfh,
sys_getfh,
freebsd4_getdomainname,
freebsd4_setdomainname,
freebsd4_uname,
sysarch,
sys_rtprio,
nosys,
nosys,
sys_semsys,
sys_msgsys,
sys_shmsys,
nosys,
freebsd6_pread,
freebsd6_pwrite,
sys_setfib,
sys_ntp_adjtime,
nosys,
nosys,
nosys,
nosys,
sys_setgid,
sys_setegid,
sys_seteuid,
nosys,
nosys,
nosys,
nosys,
sys_stat,
sys_fstat,
sys_lstat,
sys_pathconf,
sys_fpathconf,
nosys,
sys_getrlimit,
sys_setrlimit,
sys_getdirentries,
freebsd6_mmap,
nosys,
freebsd6_lseek,
freebsd6_truncate,
freebsd6_ftruncate,
sys___sysctl,
sys_mlock,
sys_munlock,
sys_undelete,
sys_futimes,
sys_getpgid,
nosys,
sys_poll,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
lkmnosys,
freebsd7___semctl,
sys_semget,
sys_semop,
nosys,
freebsd7_msgctl,
sys_msgget,
sys_msgsnd,
sys_msgrcv,
sys_shmat,
freebsd7_shmctl,
sys_shmdt,
sys_shmget,
sys_clock_gettime,
sys_clock_settime,
sys_clock_getres,
sys_ktimer_create,
sys_ktimer_delete,
sys_ktimer_settime,
sys_ktimer_gettime,
sys_ktimer_getoverrun,
sys_nanosleep,
sys_ffclock_getcounter,
sys_ffclock_setestimate,
sys_ffclock_getestimate,
sys_clock_nanosleep,
nosys,
nosys,
sys_clock_getcpuclockid2,
sys_ntp_gettime,
nosys,
sys_minherit,
sys_rfork,
sys_openbsd_poll,
sys_issetugid,
sys_lchown,
sys_aio_read,
sys_aio_write,
sys_lio_listio,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
sys_getdents,
nosys,
sys_lchmod,
sys_lchown,
sys_lutimes,
sys_msync,
sys_nstat,
sys_nfstat,
sys_nlstat,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
sys_preadv,
sys_pwritev,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
freebsd4_fhstatfs,
sys_fhopen,
sys_fhstat,
sys_modnext,
sys_modstat,
sys_modfnext,
sys_modfind,
sys_kldload,
sys_kldunload,
sys_kldfind,
sys_kldnext,
sys_kldstat,
sys_kldfirstmod,
sys_getsid,
sys_setresuid,
sys_setresgid,
nosys,
sys_aio_return,
sys_aio_suspend,
sys_aio_cancel,
sys_aio_error,
freebsd6_aio_read,
freebsd6_aio_write,
freebsd6_lio_listio,
sys_yield,
nosys,
nosys,
sys_mlockall,
sys_munlockall,
sys___getcwd,
sys_sched_setparam,
sys_sched_getparam,
sys_sched_setscheduler,
sys_sched_getscheduler,
sys_sched_yield,
sys_sched_get_priority_max,
sys_sched_get_priority_min,
sys_sched_rr_get_interval,
sys_utrace,
freebsd4_sendfile,
sys_kldsym,
sys_jail,
lkmressys,
sys_sigprocmask,
sys_sigsuspend,
freebsd4_sigaction,
sys_sigpending,
freebsd4_sigreturn,
sys_sigtimedwait,
sys_sigwaitinfo,
sys___acl_get_file,
sys___acl_set_file,
sys___acl_get_fd,
sys___acl_set_fd,
sys___acl_delete_file,
sys___acl_delete_fd,
sys___acl_aclcheck_file,
sys___acl_aclcheck_fd,
sys_extattrctl,
sys_extattr_set_file,
sys_extattr_get_file,
sys_extattr_delete_file,
sys_aio_waitcomplete,
sys_getresuid,
sys_getresgid,
sys_kqueue,
sys_kevent,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
nosys,
sys_extattr_set_fd,
sys_extattr_get_fd,
sys_extattr_delete_fd,
sys___setugid,
nosys,
sys_eaccess,
lkmressys,
sys_nmount,
nosys,
nosys,
nosys,
nosys,
nosys,
sys___mac_get_proc,
sys___mac_set_proc,
sys___mac_get_fd,
sys___mac_get_file,
sys___mac_set_fd,
sys___mac_set_file,
sys_kenv,
sys_lchflags,
sys_uuidgen,
sys_sendfile,
sys_mac_syscall,
sys_getfsstat,
sys_statfs,
sys_fstatfs,
sys_fhstatfs,
nosys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
sys___mac_get_pid,
sys___mac_get_link,
sys___mac_set_link,
sys_extattr_set_link,
sys_extattr_get_link,
sys_extattr_delete_link,
sys___mac_execve,
sys_sigaction,
sys_sigreturn,
nosys,
nosys,
nosys,
sys_getcontext,
sys_setcontext,
sys_swapcontext,
sys_swapoff,
sys___acl_get_link,
sys___acl_set_link,
sys___acl_delete_link,
sys___acl_aclcheck_link,
sys_sigwait,
sys_thr_create,
sys_thr_exit,
sys_thr_self,
sys_thr_kill,
nosys,
nosys,
sys_jail_attach,
sys_extattr_list_fd,
sys_extattr_list_file,
sys_extattr_list_link,
nosys,
lkmressys,
sys_thr_suspend,
sys_thr_wake,
sys_kldunloadf,
sys_audit,
sys_auditon,
sys_getauid,
sys_setauid,
sys_getaudit,
sys_setaudit,
sys_getaudit_addr,
sys_setaudit_addr,
sys_auditctl,
sys__umtx_op,
sys_thr_new,
sys_sigqueue,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
lkmressys,
sys_abort2,
sys_thr_set_name,
sys_aio_fsync,
sys_rtprio_thread,
nosys,
nosys,
nosys,
nosys,
sys_sctp_peeloff,
sys_sctp_generic_sendmsg,
sys_sctp_generic_sendmsg_iov,
sys_sctp_generic_recvmsg,
sys_pread,
sys_pwrite,
sys_mmap,
sys_lseek,
sys_truncate,
sys_ftruncate,
sys_thr_kill2,
sys_shm_open,
sys_shm_unlink,
sys_cpuset,
sys_cpuset_setid,
sys_cpuset_getid,
sys_cpuset_getaffinity,
sys_cpuset_setaffinity,
sys_faccessat,
sys_fchmodat,
sys_fchownat,
sys_fexecve,
sys_fstatat,
sys_futimesat,
sys_linkat,
sys_mkdirat,
sys_mkfifoat,
sys_mknodat,
sys_openat,
sys_readlinkat,
sys_renameat,
sys_symlinkat,
sys_unlinkat,
sys_posix_openpt,
lkmressys,
sys_jail_get,
sys_jail_set,
sys_jail_remove,
sys_closefrom,
sys___semctl,
sys_msgctl,
sys_shmctl,
sys_lpathconf,
nosys,
sys___cap_rights_get,
sys_cap_enter,
sys_cap_getmode,
sys_pdfork,
sys_pdkill,
sys_pdgetpid,
nosys,
sys_pselect,
sys_getloginclass,
sys_setloginclass,
sys_rctl_get_racct,
sys_rctl_get_rules,
sys_rctl_get_limits,
sys_rctl_add_rule,
sys_rctl_remove_rule,
sys_posix_fallocate,
sys_posix_fadvise,
sys_wait6,
sys_cap_rights_limit,
sys_cap_ioctls_limit,
sys_cap_ioctls_get,
sys_cap_fcntls_limit,
sys_cap_fcntls_get,
sys_bindat,
sys_connectat,
sys_chflagsat,
sys_accept4,
sys_pipe2,
sys_aio_mlock,
sys_procctl,
sys_ppoll,
sys_futimens,
sys_utimensat,
sys_numa_getaffinity,
sys_numa_setaffinity,
sys_fdatasync,
NULL
};

#endif
